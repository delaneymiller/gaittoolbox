relVel_RANK_PELo_N = [(2*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)*((d_rtibia+d_rfemur*cos(qRKN))*(4*wxPEL*((q1PEL*q4PEL+q2PEL*q3PEL)*(q1RTIB*q4RTIB+q2RTIB*q3RTIB)+(q1PEL*q3PEL-q2PEL*q4PEL)*(q1RTIB*q3RTIB-q2RTIB*q4RTIB))-wxRTIB-2*wyPEL*(2*(q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q3RTIB-q2RTIB*q4RTIB)-(q1RTIB*q4RTIB+q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q3PEL^2))-2*wzPEL*(2*(q1RTIB*q4RTIB+q2RTIB*q3RTIB)*(q1PEL*q2PEL-q3PEL*q4PEL)+(q1RTIB*q3RTIB-q2RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2)))-d_rfemur*sin(qRKN)*(wzRTIB+2*wxPEL*(2*(q1PEL*q4PEL+q2PEL*q3PEL)*(q1RTIB*q2RTIB-q3RTIB*q4RTIB)+(q1PEL*q3PEL-q2PEL*q4PEL)*(-1+2*q1RTIB^2+2*q4RTIB^2))-2*wyPEL*((q1PEL*q2PEL+q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q4RTIB^2)-(q1RTIB*q2RTIB-q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q3PEL^2))-wzPEL*(4*(q1PEL*q2PEL-q3PEL*q4PEL)*(q1RTIB*q2RTIB-q3RTIB*q4RTIB)+(-1+2*q1PEL^2+2*q4PEL^2)*(-1+2*q1RTIB^2+2*q4RTIB^2))))-2*d_rfemur*sin(qRKN)*(q1RTIB*q3RTIB+q2RTIB*q4RTIB)*(wyRTIB+2*wxPEL*(2*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(q1PEL*q3PEL-q2PEL*q4PEL)-(q1PEL*q4PEL+q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2))-wyPEL*(4*(q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)+(-1+2*q1PEL^2+2*q3PEL^2)*(-1+2*q1RTIB^2+2*q3RTIB^2))-2*wzPEL*((q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2)-(q1PEL*q2PEL-q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2))-w_RKN_scl)-(-1+2*q1RTIB^2+2*q2RTIB^2)*((d_rtibia+d_rfemur*cos(qRKN))*(wyRTIB+2*wxPEL*(2*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(q1PEL*q3PEL-q2PEL*q4PEL)-(q1PEL*q4PEL+q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2))-wyPEL*(4*(q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)+(-1+2*q1PEL^2+2*q3PEL^2)*(-1+2*q1RTIB^2+2*q3RTIB^2))-2*wzPEL*((q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2)-(q1PEL*q2PEL-q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2)))-d_rfemur*cos(qRKN)*w_RKN_scl)); ((-1+2*q1RTIB^2+2*q3RTIB^2)*(d_rfemur*sin(qRKN)*(wzRTIB+2*wyPEL*(2*(q1RTIB*q3RTIB+q2RTIB*q4RTIB)*(q1PEL*q4PEL-q2PEL*q3PEL)-(q1PEL*q2PEL+q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q4RTIB^2))-wzPEL*(4*(q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q3RTIB+q2RTIB*q4RTIB)+(-1+2*q1PEL^2+2*q4PEL^2)*(-1+2*q1RTIB^2+2*q4RTIB^2))-2*wxPEL*((q1RTIB*q3RTIB+q2RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q2PEL^2)-(q1PEL*q3PEL-q2PEL*q4PEL)*(-1+2*q1RTIB^2+2*q4RTIB^2)))+(d_rtibia+d_rfemur*cos(qRKN))*(wxRTIB+2*wyPEL*(2*(q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q3RTIB-q2RTIB*q4RTIB)+(q1PEL*q4PEL-q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q2RTIB^2))-2*wzPEL*((q1PEL*q3PEL+q2PEL*q4PEL)*(-1+2*q1RTIB^2+2*q2RTIB^2)-(q1RTIB*q3RTIB-q2RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2))-wxPEL*(4*(q1PEL*q3PEL-q2PEL*q4PEL)*(q1RTIB*q3RTIB-q2RTIB*q4RTIB)+(-1+2*q1PEL^2+2*q2PEL^2)*(-1+2*q1RTIB^2+2*q2RTIB^2))))+2*d_rfemur*sin(qRKN)*(q1RTIB*q2RTIB-q3RTIB*q4RTIB)*(wyRTIB+2*wxPEL*(2*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(q1PEL*q3PEL-q2PEL*q4PEL)+(q1RTIB*q4RTIB-q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q2PEL^2))+2*wzPEL*(2*(q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)-(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2))-4*wyPEL*((q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)+(q1PEL*q4PEL-q2PEL*q3PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB))-w_RKN_scl)+2*(q1RTIB*q4RTIB+q2RTIB*q3RTIB)*((d_rtibia+d_rfemur*cos(qRKN))*(4*wyPEL*((q1PEL*q2PEL+q3PEL*q4PEL)*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)+(q1PEL*q4PEL-q2PEL*q3PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB))-wyRTIB-2*wxPEL*(2*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(q1PEL*q3PEL-q2PEL*q4PEL)+(q1RTIB*q4RTIB-q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q2PEL^2))-2*wzPEL*(2*(q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)-(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q4PEL^2)))+d_rfemur*cos(qRKN)*w_RKN_scl)); (2*(q1RTIB*q3RTIB-q2RTIB*q4RTIB)*((d_rtibia+d_rfemur*cos(qRKN))*(wyRTIB+2*wzPEL*(2*(q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)+(q1PEL*q2PEL-q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2))-2*wxPEL*((q1PEL*q4PEL+q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2)-(q1RTIB*q4RTIB-q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q2PEL^2))-wyPEL*(4*(q1PEL*q4PEL-q2PEL*q3PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)+(-1+2*q1PEL^2+2*q3PEL^2)*(-1+2*q1RTIB^2+2*q3RTIB^2)))-d_rfemur*cos(qRKN)*w_RKN_scl)-2*(q1RTIB*q2RTIB+q3RTIB*q4RTIB)*(d_rfemur*sin(qRKN)*(4*wzPEL*((q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q3RTIB+q2RTIB*q4RTIB)+(q1PEL*q2PEL-q3PEL*q4PEL)*(q1RTIB*q2RTIB-q3RTIB*q4RTIB))-wzRTIB-2*wxPEL*(2*(q1PEL*q4PEL+q2PEL*q3PEL)*(q1RTIB*q2RTIB-q3RTIB*q4RTIB)-(q1RTIB*q3RTIB+q2RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q2PEL^2))-2*wyPEL*(2*(q1RTIB*q3RTIB+q2RTIB*q4RTIB)*(q1PEL*q4PEL-q2PEL*q3PEL)+(q1RTIB*q2RTIB-q3RTIB*q4RTIB)*(-1+2*q1PEL^2+2*q3PEL^2)))-(d_rtibia+d_rfemur*cos(qRKN))*(wxRTIB+2*wzPEL*(2*(q1RTIB*q4RTIB+q2RTIB*q3RTIB)*(q1PEL*q2PEL-q3PEL*q4PEL)-(q1PEL*q3PEL+q2PEL*q4PEL)*(-1+2*q1RTIB^2+2*q2RTIB^2))-wxPEL*(4*(q1PEL*q4PEL+q2PEL*q3PEL)*(q1RTIB*q4RTIB+q2RTIB*q3RTIB)+(-1+2*q1PEL^2+2*q2PEL^2)*(-1+2*q1RTIB^2+2*q2RTIB^2))-2*wyPEL*((q1RTIB*q4RTIB+q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q3PEL^2)-(q1PEL*q4PEL-q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q2RTIB^2))))-d_rfemur*sin(qRKN)*(-1+2*q1RTIB^2+2*q4RTIB^2)*(wyRTIB+2*wzPEL*(2*(q1PEL*q3PEL+q2PEL*q4PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)+(q1PEL*q2PEL-q3PEL*q4PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2))-2*wxPEL*((q1PEL*q4PEL+q2PEL*q3PEL)*(-1+2*q1RTIB^2+2*q3RTIB^2)-(q1RTIB*q4RTIB-q2RTIB*q3RTIB)*(-1+2*q1PEL^2+2*q2PEL^2))-wyPEL*(4*(q1PEL*q4PEL-q2PEL*q3PEL)*(q1RTIB*q4RTIB-q2RTIB*q3RTIB)+(-1+2*q1PEL^2+2*q3PEL^2)*(-1+2*q1RTIB^2+2*q3RTIB^2))-w_RKN_scl))];